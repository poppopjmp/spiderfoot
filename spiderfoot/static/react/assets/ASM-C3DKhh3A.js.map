{"version":3,"file":"ASM-C3DKhh3A.js","sources":["../../../../frontend/node_modules/lucide-react/dist/esm/icons/external-link.js","../../../../frontend/src/pages/ASM.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ExternalLink = createLucideIcon(\"ExternalLink\", [\n  [\"path\", { d: \"M15 3h6v6\", key: \"1q9fwt\" }],\n  [\"path\", { d: \"M10 14 21 3\", key: \"gplh6r\" }],\n  [\"path\", { d: \"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\", key: \"a6xqqp\" }]\n]);\n\nexport { ExternalLink as default };\n//# sourceMappingURL=external-link.js.map\n","import { useQuery } from '@tanstack/react-query';\r\nimport { asmApi } from '../lib/api';\r\nimport { Globe, Shield, AlertTriangle, Server, ExternalLink } from 'lucide-react';\r\n\r\nexport default function ASMPage() {\r\n  const { data: dashboard } = useQuery({ queryKey: ['asm-dashboard'], queryFn: asmApi.dashboard });\r\n  const { data: assets } = useQuery({ queryKey: ['asm-assets'], queryFn: asmApi.listAssets });\r\n  const { data: policies } = useQuery({ queryKey: ['asm-policies'], queryFn: asmApi.policies });\r\n\r\n  const assetList = assets?.assets ?? [];\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-bold text-white mb-6\">Attack Surface Management</h1>\r\n\r\n      {/* Dashboard */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n        {[\r\n          { label: 'Total Assets', value: dashboard?.total_assets ?? assetList.length, icon: Globe, color: 'text-spider-400' },\r\n          { label: 'Critical Exposure', value: dashboard?.critical ?? 0, icon: AlertTriangle, color: 'text-red-400' },\r\n          { label: 'Active Policies', value: dashboard?.active_policies ?? (policies?.policies?.length ?? 0), icon: Shield, color: 'text-green-400' },\r\n          { label: 'External Services', value: dashboard?.external_services ?? 0, icon: ExternalLink, color: 'text-blue-400' },\r\n        ].map((s) => (\r\n          <div key={s.label} className=\"card flex items-center gap-3\">\r\n            <s.icon className={`h-5 w-5 ${s.color}`} />\r\n            <div>\r\n              <p className=\"text-sm text-dark-400\">{s.label}</p>\r\n              <p className=\"text-xl font-bold text-white\">{s.value}</p>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Assets table */}\r\n      <div className=\"card mb-6\">\r\n        <h2 className=\"text-lg font-semibold text-white mb-4\">Discovered Assets</h2>\r\n        {assetList.length > 0 ? (\r\n          <table className=\"w-full text-sm\">\r\n            <thead>\r\n              <tr className=\"text-left text-dark-400 border-b border-dark-700\">\r\n                <th className=\"pb-3 font-medium\">Asset</th>\r\n                <th className=\"pb-3 font-medium\">Type</th>\r\n                <th className=\"pb-3 font-medium\">Risk</th>\r\n                <th className=\"pb-3 font-medium\">Last Seen</th>\r\n                <th className=\"pb-3 font-medium\">Tags</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-dark-700\">\r\n              {assetList.map((a: { id: string; name: string; type: string; risk: string; last_seen: string; tags?: string[] }) => (\r\n                <tr key={a.id} className=\"hover:bg-dark-700/50\">\r\n                  <td className=\"py-3 text-white flex items-center gap-2\">\r\n                    <Server className=\"h-4 w-4 text-dark-400\" /> {a.name}\r\n                  </td>\r\n                  <td className=\"py-3\"><span className=\"badge badge-info\">{a.type}</span></td>\r\n                  <td className=\"py-3\">\r\n                    <span className={`badge ${\r\n                      a.risk === 'critical' ? 'badge-critical' :\r\n                      a.risk === 'high' ? 'badge-high' :\r\n                      a.risk === 'medium' ? 'badge-medium' : 'badge-low'\r\n                    }`}>{a.risk}</span>\r\n                  </td>\r\n                  <td className=\"py-3 text-dark-400\">{a.last_seen}</td>\r\n                  <td className=\"py-3\">\r\n                    <div className=\"flex gap-1\">\r\n                      {a.tags?.map((t) => <span key={t} className=\"badge badge-low text-xs\">{t}</span>)}\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        ) : (\r\n          <div className=\"text-center py-8\">\r\n            <Globe className=\"h-12 w-12 text-dark-600 mx-auto mb-3\" />\r\n            <p className=\"text-dark-400\">No assets discovered yet.</p>\r\n            <p className=\"text-sm text-dark-500 mt-1\">\r\n              Run a scan with ASM modules enabled to discover your external attack surface.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Policies */}\r\n      {policies?.policies && policies.policies.length > 0 && (\r\n        <div className=\"card\">\r\n          <h2 className=\"text-lg font-semibold text-white mb-4\">Security Policies</h2>\r\n          <div className=\"space-y-2\">\r\n            {policies.policies.map((p: { id: string; name: string; description: string; enabled: boolean }) => (\r\n              <div key={p.id} className=\"flex items-center justify-between p-3 bg-dark-700/50 rounded-lg\">\r\n                <div>\r\n                  <p className=\"text-white font-medium text-sm\">{p.name}</p>\r\n                  <p className=\"text-xs text-dark-400\">{p.description}</p>\r\n                </div>\r\n                <span className={`badge ${p.enabled ? 'badge-success' : 'badge-info'}`}>\r\n                  {p.enabled ? 'Active' : 'Disabled'}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["ExternalLink","createLucideIcon","ASMPage","dashboard","useQuery","asmApi","assets","policies","assetList","jsx","Globe","AlertTriangle","_a","Shield","jsxs","a","Server","t","p"],"mappings":"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","x_google_ignoreList":[0]}
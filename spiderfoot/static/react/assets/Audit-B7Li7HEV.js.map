{"version":3,"file":"Audit-B7Li7HEV.js","sources":["../../../../frontend/src/pages/Audit.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\r\nimport { auditApi } from '../lib/api';\r\nimport { FileText, Filter, BarChart3 } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nexport default function AuditPage() {\r\n  const [actionFilter, setActionFilter] = useState('');\r\n  const { data: logs, isLoading } = useQuery({\r\n    queryKey: ['audit-logs', actionFilter],\r\n    queryFn: () => auditApi.list({ limit: 100, action: actionFilter || undefined }),\r\n  });\r\n  const { data: stats } = useQuery({ queryKey: ['audit-stats'], queryFn: auditApi.stats });\r\n\r\n  const entries = logs?.logs ?? logs?.entries ?? [];\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-bold text-white mb-6\">Audit Log</h1>\r\n\r\n      {/* Stats */}\r\n      {stats && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n          {[\r\n            { label: 'Total Events', value: stats.total ?? 0, color: 'text-spider-400' },\r\n            { label: 'Today', value: stats.today ?? 0, color: 'text-blue-400' },\r\n            { label: 'Unique Users', value: stats.unique_users ?? 0, color: 'text-purple-400' },\r\n            { label: 'Failed Actions', value: stats.failed ?? 0, color: 'text-red-400' },\r\n          ].map((s) => (\r\n            <div key={s.label} className=\"card flex items-center gap-3\">\r\n              <BarChart3 className={`h-5 w-5 ${s.color}`} />\r\n              <div>\r\n                <p className=\"text-sm text-dark-400\">{s.label}</p>\r\n                <p className=\"text-xl font-bold text-white\">{s.value}</p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Filter */}\r\n      <div className=\"flex items-center gap-3 mb-4\">\r\n        <Filter className=\"h-4 w-4 text-dark-400\" />\r\n        <select\r\n          className=\"input-field w-48\"\r\n          value={actionFilter}\r\n          onChange={(e) => setActionFilter(e.target.value)}\r\n        >\r\n          <option value=\"\">All Actions</option>\r\n          <option value=\"scan.create\">Scan Create</option>\r\n          <option value=\"scan.delete\">Scan Delete</option>\r\n          <option value=\"config.update\">Config Update</option>\r\n          <option value=\"api_key.create\">API Key Create</option>\r\n          <option value=\"rbac.assign\">Role Assignment</option>\r\n          <option value=\"login\">Login</option>\r\n          <option value=\"export\">Export</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Log entries */}\r\n      <div className=\"card\">\r\n        {isLoading ? (\r\n          <p className=\"text-dark-400\">Loading audit log...</p>\r\n        ) : entries.length > 0 ? (\r\n          <div className=\"space-y-2\">\r\n            {entries.map((entry: { id: string; action: string; user: string; timestamp: string; details?: string; success?: boolean }, i: number) => (\r\n              <div\r\n                key={entry.id || i}\r\n                className=\"flex items-center justify-between p-3 bg-dark-700/50 rounded-lg\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <FileText className=\"h-4 w-4 text-dark-400\" />\r\n                  <div>\r\n                    <p className=\"text-sm text-white\">\r\n                      <span className=\"badge badge-info mr-2\">{entry.action}</span>\r\n                      {entry.details || ''}\r\n                    </p>\r\n                    <p className=\"text-xs text-dark-400\">\r\n                      {entry.user} Â· {entry.timestamp}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <span className={`badge ${entry.success !== false ? 'badge-success' : 'badge-critical'}`}>\r\n                  {entry.success !== false ? 'OK' : 'FAILED'}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-dark-400\">No audit log entries found.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["AuditPage","actionFilter","setActionFilter","useState","logs","isLoading","useQuery","auditApi","stats","entries","jsx","jsxs","BarChart3","Filter","e","entry","i","FileText"],"mappings":"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"}
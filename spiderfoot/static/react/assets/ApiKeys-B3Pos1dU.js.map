{"version":3,"file":"ApiKeys-B3Pos1dU.js","sources":["../../../../frontend/node_modules/lucide-react/dist/esm/icons/ban.js","../../../../frontend/src/pages/ApiKeys.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Ban = createLucideIcon(\"Ban\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m4.9 4.9 14.2 14.2\", key: \"1m5liu\" }]\n]);\n\nexport { Ban as default };\n//# sourceMappingURL=ban.js.map\n","/**\r\n * SpiderFoot API Key Management Page\r\n *\r\n * Create, list, revoke, and delete API keys.\r\n * Users can manage their own keys; admins can manage all keys.\r\n * Supports fine-grained permissions: allowed modules/endpoints, rate limits.\r\n */\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Key,\r\n  Plus,\r\n  Trash2,\r\n  Shield,\r\n  CheckCircle,\r\n  Search,\r\n  X,\r\n  AlertCircle,\r\n  ChevronDown,\r\n  Clock,\r\n  Copy,\r\n  Eye,\r\n  EyeOff,\r\n  Ban,\r\n} from 'lucide-react';\r\nimport { clsx } from 'clsx';\r\nimport api from '../lib/api';\r\nimport { useAuthStore } from '../lib/auth';\r\n\r\n// ── Types ────────────────────────────────────────────────\r\n\r\ninterface ApiKeyRecord {\r\n  id: string;\r\n  user_id: string;\r\n  name: string;\r\n  key_prefix: string;\r\n  role: string;\r\n  status: string;\r\n  expires_at: number;\r\n  allowed_modules: string;\r\n  allowed_endpoints: string;\r\n  rate_limit: number;\r\n  last_used: number;\r\n  created_at: number;\r\n  updated_at: number;\r\n  // Only present on creation\r\n  key?: string;\r\n}\r\n\r\nconst ROLES = ['viewer', 'analyst', 'operator', 'admin'] as const;\r\n\r\nconst ROLE_BADGE_COLOR: Record<string, string> = {\r\n  admin: 'bg-red-500/15 text-red-400 border-red-500/30',\r\n  operator: 'bg-orange-500/15 text-orange-400 border-orange-500/30',\r\n  analyst: 'bg-blue-500/15 text-blue-400 border-blue-500/30',\r\n  viewer: 'bg-dark-600/50 text-dark-300 border-dark-600',\r\n};\r\n\r\nconst STATUS_STYLES: Record<string, { icon: React.ReactNode; color: string }> = {\r\n  active: { icon: <CheckCircle className=\"h-3.5 w-3.5 text-green-400\" />, color: 'text-green-400' },\r\n  revoked: { icon: <Ban className=\"h-3.5 w-3.5 text-red-400\" />, color: 'text-red-400' },\r\n  expired: { icon: <Clock className=\"h-3.5 w-3.5 text-yellow-400\" />, color: 'text-yellow-400' },\r\n};\r\n\r\n// ── Helpers ──────────────────────────────────────────────\r\n\r\nfunction formatDate(ts: number): string {\r\n  if (!ts) return '—';\r\n  return new Date(ts * 1000).toLocaleString();\r\n}\r\n\r\nfunction relativeTime(ts: number): string {\r\n  if (!ts) return 'Never';\r\n  const diff = Date.now() / 1000 - ts;\r\n  if (diff < 60) return 'Just now';\r\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\r\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\r\n  return `${Math.floor(diff / 86400)}d ago`;\r\n}\r\n\r\nfunction expiresLabel(ts: number): string {\r\n  if (!ts) return 'Never';\r\n  const diff = ts - Date.now() / 1000;\r\n  if (diff < 0) return 'Expired';\r\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h left`;\r\n  return `${Math.floor(diff / 86400)}d left`;\r\n}\r\n\r\n// ── Component ────────────────────────────────────────────\r\n\r\nexport default function ApiKeysPage() {\r\n  const { user: currentUser, hasPermission } = useAuthStore();\r\n  const isAdmin = hasPermission('user:read');\r\n\r\n  const [keys, setKeys] = useState<ApiKeyRecord[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [search, setSearch] = useState('');\r\n\r\n  // Modals\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [newKeyResult, setNewKeyResult] = useState<ApiKeyRecord | null>(null);\r\n  const [deleteKey, setDeleteKey] = useState<ApiKeyRecord | null>(null);\r\n  const [revokeKey, setRevokeKey] = useState<ApiKeyRecord | null>(null);\r\n\r\n  // ── Data fetching ──────────────────────────────────────\r\n\r\n  const fetchKeys = useCallback(async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const url = isAdmin ? '/api/auth/api-keys' : '/api/auth/api-keys/mine';\r\n      const res = await api.get(url);\r\n      setKeys(res.data.items || []);\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.detail || err.message || 'Failed to load API keys');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [isAdmin]);\r\n\r\n  useEffect(() => {\r\n    fetchKeys();\r\n  }, [fetchKeys]);\r\n\r\n  // ── Filter ─────────────────────────────────────────────\r\n\r\n  const filtered = keys.filter((k) => {\r\n    if (!search) return true;\r\n    const q = search.toLowerCase();\r\n    return (\r\n      k.name.toLowerCase().includes(q) ||\r\n      k.key_prefix.toLowerCase().includes(q) ||\r\n      k.role.toLowerCase().includes(q) ||\r\n      k.status.toLowerCase().includes(q)\r\n    );\r\n  });\r\n\r\n  // ── Revoke handler ─────────────────────────────────────\r\n\r\n  const handleRevoke = async (k: ApiKeyRecord) => {\r\n    try {\r\n      await api.post(`/api/auth/api-keys/${k.id}/revoke`);\r\n      fetchKeys();\r\n      setRevokeKey(null);\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.detail || 'Failed to revoke key');\r\n    }\r\n  };\r\n\r\n  // ── Delete handler ─────────────────────────────────────\r\n\r\n  const handleDelete = async (k: ApiKeyRecord) => {\r\n    try {\r\n      await api.delete(`/api/auth/api-keys/${k.id}`);\r\n      fetchKeys();\r\n      setDeleteKey(null);\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.detail || 'Failed to delete key');\r\n    }\r\n  };\r\n\r\n  // ── Render ─────────────────────────────────────────────\r\n\r\n  return (\r\n    <div>\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-white flex items-center gap-3\">\r\n            <Key className=\"h-7 w-7 text-spider-400\" />\r\n            API Keys\r\n          </h1>\r\n          <p className=\"text-dark-400 text-sm mt-1\">\r\n            Generate API keys for programmatic access with fine-grained permissions\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowCreate(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-spider-600 hover:bg-spider-500 text-white rounded-lg text-sm font-medium transition-colors\"\r\n        >\r\n          <Plus className=\"h-4 w-4\" />\r\n          Generate Key\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <div className=\"relative mb-4\">\r\n        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dark-500\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search keys...\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          className=\"w-full pl-10 pr-10 py-2.5 bg-dark-800 border border-dark-700 rounded-lg text-sm text-white placeholder:text-dark-500 focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60\"\r\n        />\r\n        {search && (\r\n          <button onClick={() => setSearch('')} className=\"absolute right-3 top-1/2 -translate-y-1/2 text-dark-500 hover:text-dark-300\">\r\n            <X className=\"h-4 w-4\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Error */}\r\n      {error && (\r\n        <div className=\"mb-4 flex items-center gap-2 px-4 py-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm\">\r\n          <AlertCircle className=\"h-4 w-4 flex-shrink-0\" />\r\n          {error}\r\n          <button onClick={() => setError('')} className=\"ml-auto text-red-500 hover:text-red-300\">\r\n            <X className=\"h-3 w-3\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Table */}\r\n      <div className=\"bg-dark-800 border border-dark-700 rounded-xl overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead>\r\n              <tr className=\"border-b border-dark-700 text-dark-400 text-left\">\r\n                <th className=\"px-4 py-3 font-medium\">Name</th>\r\n                <th className=\"px-4 py-3 font-medium\">Key Prefix</th>\r\n                <th className=\"px-4 py-3 font-medium\">Role</th>\r\n                <th className=\"px-4 py-3 font-medium\">Status</th>\r\n                <th className=\"px-4 py-3 font-medium\">Permissions</th>\r\n                <th className=\"px-4 py-3 font-medium\">Last Used</th>\r\n                <th className=\"px-4 py-3 font-medium\">Expires</th>\r\n                <th className=\"px-4 py-3 font-medium text-right\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr>\r\n                  <td colSpan={8} className=\"px-4 py-12 text-center text-dark-500\">\r\n                    <div className=\"flex items-center justify-center gap-2\">\r\n                      <div className=\"animate-spin h-5 w-5 border-2 border-spider-500 border-t-transparent rounded-full\" />\r\n                      Loading API keys...\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : filtered.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={8} className=\"px-4 py-12 text-center text-dark-500\">\r\n                    {search ? 'No keys match your search' : 'No API keys yet. Click \"Generate Key\" to create one.'}\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                filtered.map((k) => {\r\n                  const statusStyle = STATUS_STYLES[k.status] || STATUS_STYLES.active;\r\n                  const modules = k.allowed_modules ? JSON.parse(k.allowed_modules) : [];\r\n                  const isExpired = k.expires_at > 0 && k.expires_at < Date.now() / 1000;\r\n\r\n                  return (\r\n                    <tr key={k.id} className=\"border-b border-dark-700/50 hover:bg-dark-750 transition-colors\">\r\n                      <td className=\"px-4 py-3\">\r\n                        <p className=\"text-white font-medium\">{k.name}</p>\r\n                        <p className=\"text-dark-500 text-xs\">{formatDate(k.created_at)}</p>\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        <code className=\"text-dark-300 font-mono text-xs bg-dark-900 px-2 py-0.5 rounded\">\r\n                          {k.key_prefix}...\r\n                        </code>\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        <span className={clsx(\r\n                          'inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium border',\r\n                          ROLE_BADGE_COLOR[k.role] || ROLE_BADGE_COLOR.viewer,\r\n                        )}>\r\n                          <Shield className=\"h-3 w-3\" />\r\n                          {k.role}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        <div className=\"flex items-center gap-1.5\">\r\n                          {isExpired ? STATUS_STYLES.expired.icon : statusStyle.icon}\r\n                          <span className={clsx('capitalize', isExpired ? 'text-yellow-400' : statusStyle.color)}>\r\n                            {isExpired ? 'expired' : k.status}\r\n                          </span>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        <div className=\"space-y-0.5\">\r\n                          {modules.length > 0 ? (\r\n                            <p className=\"text-xs text-dark-400\">\r\n                              {modules.length} module{modules.length !== 1 ? 's' : ''}\r\n                            </p>\r\n                          ) : (\r\n                            <p className=\"text-xs text-dark-500\">All modules</p>\r\n                          )}\r\n                          {k.rate_limit > 0 && (\r\n                            <p className=\"text-xs text-dark-500\">{k.rate_limit} req/min</p>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-4 py-3 text-dark-400 text-xs\">\r\n                        {relativeTime(k.last_used)}\r\n                      </td>\r\n                      <td className=\"px-4 py-3 text-dark-400 text-xs\">\r\n                        {expiresLabel(k.expires_at)}\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        <div className=\"flex items-center justify-end gap-1\">\r\n                          {k.status === 'active' && (\r\n                            <button\r\n                              onClick={() => setRevokeKey(k)}\r\n                              className=\"p-1.5 text-dark-500 hover:text-yellow-400 hover:bg-dark-700 rounded-lg transition-colors\"\r\n                              title=\"Revoke key\"\r\n                            >\r\n                              <Ban className=\"h-3.5 w-3.5\" />\r\n                            </button>\r\n                          )}\r\n                          <button\r\n                            onClick={() => setDeleteKey(k)}\r\n                            className=\"p-1.5 text-dark-500 hover:text-red-400 hover:bg-dark-700 rounded-lg transition-colors\"\r\n                            title=\"Delete key\"\r\n                          >\r\n                            <Trash2 className=\"h-3.5 w-3.5\" />\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      {showCreate && (\r\n        <CreateKeyModal\r\n          userRole={currentUser?.role || 'viewer'}\r\n          onClose={() => setShowCreate(false)}\r\n          onCreated={(result) => {\r\n            setShowCreate(false);\r\n            setNewKeyResult(result);\r\n            fetchKeys();\r\n          }}\r\n        />\r\n      )}\r\n      {newKeyResult && (\r\n        <KeyCreatedModal\r\n          apiKey={newKeyResult}\r\n          onClose={() => setNewKeyResult(null)}\r\n        />\r\n      )}\r\n      {revokeKey && (\r\n        <ConfirmModal\r\n          title=\"Revoke API Key\"\r\n          message={<>Are you sure you want to revoke <span className=\"text-white font-medium\">{revokeKey.name}</span>? The key will immediately stop working.</>}\r\n          confirmLabel=\"Revoke\"\r\n          confirmClass=\"bg-yellow-600 hover:bg-yellow-500\"\r\n          onConfirm={() => handleRevoke(revokeKey)}\r\n          onClose={() => setRevokeKey(null)}\r\n        />\r\n      )}\r\n      {deleteKey && (\r\n        <ConfirmModal\r\n          title=\"Delete API Key\"\r\n          message={<>Are you sure you want to permanently delete <span className=\"text-white font-medium\">{deleteKey.name}</span>? This cannot be undone.</>}\r\n          confirmLabel=\"Delete\"\r\n          confirmClass=\"bg-red-600 hover:bg-red-500\"\r\n          onConfirm={() => handleDelete(deleteKey)}\r\n          onClose={() => setDeleteKey(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n// ══════════════════════════════════════════════════════════\r\n// Shared UI\r\n// ══════════════════════════════════════════════════════════\r\n\r\nfunction ModalShell({ title, onClose, children, wide }: {\r\n  title: string; onClose: () => void; children: React.ReactNode; wide?: boolean;\r\n}) {\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n      <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm\" onClick={onClose} />\r\n      <div className={clsx(\r\n        'relative bg-dark-800 border border-dark-700 rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[90vh] overflow-y-auto',\r\n        wide ? 'max-w-2xl w-full' : 'max-w-lg w-full',\r\n      )}>\r\n        <div className=\"flex items-center justify-between mb-5\">\r\n          <h2 className=\"text-lg font-bold text-white\">{title}</h2>\r\n          <button onClick={onClose} className=\"text-dark-500 hover:text-dark-300 transition-colors\">\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction FormField({ label, hint, children }: { label: string; hint?: string; children: React.ReactNode }) {\r\n  return (\r\n    <div className=\"space-y-1.5\">\r\n      <label className=\"block text-sm font-medium text-dark-300\">{label}</label>\r\n      {children}\r\n      {hint && <p className=\"text-xs text-dark-500\">{hint}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst inputClass =\r\n  'w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded-lg text-sm text-white placeholder:text-dark-500 focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60';\r\n\r\nconst selectClass =\r\n  'w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60 appearance-none';\r\n\r\n\r\n// ══════════════════════════════════════════════════════════\r\n// Create API Key Modal\r\n// ══════════════════════════════════════════════════════════\r\n\r\nfunction CreateKeyModal({\r\n  userRole,\r\n  onClose,\r\n  onCreated,\r\n}: {\r\n  userRole: string;\r\n  onClose: () => void;\r\n  onCreated: (key: ApiKeyRecord) => void;\r\n}) {\r\n  const [name, setName] = useState('');\r\n  const [role, setRole] = useState(userRole);\r\n  const [expiresInDays, setExpiresInDays] = useState(90);\r\n  const [rateLimit, setRateLimit] = useState(0);\r\n  const [allowedModules, setAllowedModules] = useState('');\r\n  const [allowedEndpoints, setAllowedEndpoints] = useState('');\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  // Only show roles up to user's current role\r\n  const roleIndex = ROLES.indexOf(userRole as typeof ROLES[number]);\r\n  const availableRoles = ROLES.slice(0, roleIndex >= 0 ? roleIndex + 1 : 1);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setSaving(true);\r\n    setError('');\r\n\r\n    // Parse module list\r\n    let modulesJson = '';\r\n    if (allowedModules.trim()) {\r\n      try {\r\n        // Accept comma-separated or JSON array\r\n        const mods = allowedModules.includes('[')\r\n          ? JSON.parse(allowedModules)\r\n          : allowedModules.split(',').map((m) => m.trim()).filter(Boolean);\r\n        modulesJson = JSON.stringify(mods);\r\n      } catch {\r\n        setError('Allowed modules must be comma-separated names or a JSON array');\r\n        setSaving(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    let endpointsJson = '';\r\n    if (allowedEndpoints.trim()) {\r\n      try {\r\n        const eps = allowedEndpoints.includes('[')\r\n          ? JSON.parse(allowedEndpoints)\r\n          : allowedEndpoints.split(',').map((e) => e.trim()).filter(Boolean);\r\n        endpointsJson = JSON.stringify(eps);\r\n      } catch {\r\n        setError('Allowed endpoints must be comma-separated patterns or a JSON array');\r\n        setSaving(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const res = await api.post('/api/auth/api-keys', {\r\n        name,\r\n        role,\r\n        expires_in_days: expiresInDays,\r\n        rate_limit: rateLimit,\r\n        allowed_modules: modulesJson,\r\n        allowed_endpoints: endpointsJson,\r\n      });\r\n      onCreated(res.data);\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.detail || 'Failed to create API key');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ModalShell title=\"Generate API Key\" onClose={onClose} wide>\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        {error && (\r\n          <div className=\"flex items-center gap-2 px-3 py-2 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm\">\r\n            <AlertCircle className=\"h-4 w-4 flex-shrink-0\" />\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <FormField label=\"Key Name\" hint=\"A descriptive name for this key (e.g. 'CI/CD Pipeline', 'Monitoring Script')\">\r\n          <input type=\"text\" value={name} onChange={(e) => setName(e.target.value)} required className={inputClass} placeholder=\"My API Key\" />\r\n        </FormField>\r\n\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <FormField label=\"Role\" hint=\"Maximum permission level for this key\">\r\n            <div className=\"relative\">\r\n              <select value={role} onChange={(e) => setRole(e.target.value)} className={selectClass}>\r\n                {availableRoles.map((r) => (\r\n                  <option key={r} value={r}>{r.charAt(0).toUpperCase() + r.slice(1)}</option>\r\n                ))}\r\n              </select>\r\n              <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dark-500 pointer-events-none\" />\r\n            </div>\r\n          </FormField>\r\n          <FormField label=\"Expires In (days)\" hint=\"0 = never expires\">\r\n            <input type=\"number\" value={expiresInDays} onChange={(e) => setExpiresInDays(parseInt(e.target.value) || 0)} min={0} className={inputClass} />\r\n          </FormField>\r\n        </div>\r\n\r\n        <FormField label=\"Rate Limit (requests/min)\" hint=\"0 = unlimited\">\r\n          <input type=\"number\" value={rateLimit} onChange={(e) => setRateLimit(parseInt(e.target.value) || 0)} min={0} className={inputClass} />\r\n        </FormField>\r\n\r\n        <div className=\"pt-2 border-t border-dark-700/50\">\r\n          <p className=\"text-xs text-dark-500 font-medium uppercase tracking-wider mb-3\">Fine-Grained Access Control</p>\r\n\r\n          <FormField label=\"Allowed Modules\" hint=\"Comma-separated module names (empty = all modules accessible). e.g. sfp_dns,sfp_whois,sfp_shodan\">\r\n            <textarea\r\n              value={allowedModules}\r\n              onChange={(e) => setAllowedModules(e.target.value)}\r\n              rows={2}\r\n              className={clsx(inputClass, 'font-mono text-xs')}\r\n              placeholder=\"sfp_dns, sfp_whois, sfp_shodan\"\r\n            />\r\n          </FormField>\r\n\r\n          <div className=\"mt-3\">\r\n            <FormField label=\"Allowed API Endpoints\" hint=\"Comma-separated URL patterns (empty = all endpoints). e.g. /api/scans/*, /api/data/*\">\r\n              <textarea\r\n                value={allowedEndpoints}\r\n                onChange={(e) => setAllowedEndpoints(e.target.value)}\r\n                rows={2}\r\n                className={clsx(inputClass, 'font-mono text-xs')}\r\n                placeholder=\"/api/scans/*, /api/data/*\"\r\n              />\r\n            </FormField>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end gap-3 pt-2\">\r\n          <button type=\"button\" onClick={onClose} className=\"px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors\">\r\n            Cancel\r\n          </button>\r\n          <button type=\"submit\" disabled={saving || !name.trim()} className=\"px-4 py-2 bg-spider-600 hover:bg-spider-500 disabled:opacity-50 text-white rounded-lg text-sm font-medium transition-colors\">\r\n            {saving ? 'Generating...' : 'Generate Key'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </ModalShell>\r\n  );\r\n}\r\n\r\n\r\n// ══════════════════════════════════════════════════════════\r\n// Key Created Modal (shows the raw key once)\r\n// ══════════════════════════════════════════════════════════\r\n\r\nfunction KeyCreatedModal({ apiKey, onClose }: { apiKey: ApiKeyRecord; onClose: () => void }) {\r\n  const [copied, setCopied] = useState(false);\r\n  const [revealed, setRevealed] = useState(false);\r\n\r\n  const copyKey = () => {\r\n    if (apiKey.key) {\r\n      navigator.clipboard.writeText(apiKey.key);\r\n      setCopied(true);\r\n      setTimeout(() => setCopied(false), 2000);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ModalShell title=\"API Key Created\" onClose={onClose}>\r\n      <div className=\"space-y-4\">\r\n        <div className=\"px-4 py-3 bg-green-500/5 border border-green-500/20 rounded-lg\">\r\n          <div className=\"flex items-center gap-2 text-green-400 text-sm font-medium mb-2\">\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            Key generated successfully\r\n          </div>\r\n          <p className=\"text-xs text-dark-400 mb-3\">\r\n            Copy this key now — it will <span className=\"text-white font-medium\">not be shown again</span>.\r\n          </p>\r\n          <div className=\"flex items-center gap-2\">\r\n            <code className={clsx(\r\n              'flex-1 text-xs font-mono px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg',\r\n              revealed ? 'text-green-300' : 'text-dark-500',\r\n            )}>\r\n              {revealed ? apiKey.key : '••••••••••••••••••••••••••••••••'}\r\n            </code>\r\n            <button\r\n              onClick={() => setRevealed(!revealed)}\r\n              className=\"p-2 text-dark-500 hover:text-dark-300 transition-colors\"\r\n              title={revealed ? 'Hide' : 'Reveal'}\r\n            >\r\n              {revealed ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n            </button>\r\n            <button\r\n              onClick={copyKey}\r\n              className={clsx(\r\n                'p-2 rounded-lg transition-colors',\r\n                copied ? 'text-green-400 bg-green-500/10' : 'text-dark-500 hover:text-dark-300 hover:bg-dark-700',\r\n              )}\r\n              title=\"Copy to clipboard\"\r\n            >\r\n              <Copy className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2 text-sm\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-dark-400\">Name</span>\r\n            <span className=\"text-white\">{apiKey.name}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-dark-400\">Role</span>\r\n            <span className=\"text-white capitalize\">{apiKey.role}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-dark-400\">Prefix</span>\r\n            <code className=\"text-dark-300 font-mono text-xs\">{apiKey.key_prefix}</code>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-dark-400\">Expires</span>\r\n            <span className=\"text-white\">{expiresLabel(apiKey.expires_at)}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-dark-900/50 border border-dark-700 rounded-lg p-3 text-xs text-dark-400\">\r\n          <p className=\"font-medium text-dark-300 mb-1\">Usage Example:</p>\r\n          <code className=\"block text-dark-500 whitespace-pre-wrap\">\r\n{`curl -H \"Authorization: Bearer ${apiKey.key || 'sf_xxxx_...'}\" \\\\\r\n     ${window.location.origin}/api/scans`}\r\n          </code>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end pt-2\">\r\n          <button onClick={onClose} className=\"px-4 py-2 bg-spider-600 hover:bg-spider-500 text-white rounded-lg text-sm font-medium transition-colors\">\r\n            Done\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </ModalShell>\r\n  );\r\n}\r\n\r\n\r\n// ══════════════════════════════════════════════════════════\r\n// Generic Confirm Modal\r\n// ══════════════════════════════════════════════════════════\r\n\r\nfunction ConfirmModal({\r\n  title,\r\n  message,\r\n  confirmLabel,\r\n  confirmClass,\r\n  onConfirm,\r\n  onClose,\r\n}: {\r\n  title: string;\r\n  message: React.ReactNode;\r\n  confirmLabel: string;\r\n  confirmClass: string;\r\n  onConfirm: () => void;\r\n  onClose: () => void;\r\n}) {\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleConfirm = async () => {\r\n    setLoading(true);\r\n    await onConfirm();\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <ModalShell title={title} onClose={onClose}>\r\n      <div className=\"space-y-4\">\r\n        <p className=\"text-dark-300 text-sm\">{message}</p>\r\n        <div className=\"flex justify-end gap-3 pt-2\">\r\n          <button type=\"button\" onClick={onClose} className=\"px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors\">\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleConfirm}\r\n            disabled={loading}\r\n            className={clsx('px-4 py-2 disabled:opacity-50 text-white rounded-lg text-sm font-medium transition-colors', confirmClass)}\r\n          >\r\n            {loading ? 'Processing...' : confirmLabel}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </ModalShell>\r\n  );\r\n}\r\n"],"names":["Ban","createLucideIcon","ROLES","ROLE_BADGE_COLOR","STATUS_STYLES","jsx","CheckCircle","Clock","formatDate","ts","relativeTime","diff","expiresLabel","ApiKeysPage","currentUser","hasPermission","useAuthStore","isAdmin","keys","setKeys","useState","loading","setLoading","error","setError","search","setSearch","showCreate","setShowCreate","newKeyResult","setNewKeyResult","deleteKey","setDeleteKey","revokeKey","setRevokeKey","fetchKeys","useCallback","url","res","api","err","_b","_a","useEffect","filtered","k","q","handleRevoke","handleDelete","jsxs","Key","Plus","Search","e","X","AlertCircle","statusStyle","modules","isExpired","clsx","Shield","Trash2","CreateKeyModal","result","KeyCreatedModal","ConfirmModal","Fragment","ModalShell","title","onClose","children","wide","FormField","label","hint","inputClass","selectClass","userRole","onCreated","name","setName","role","setRole","expiresInDays","setExpiresInDays","rateLimit","setRateLimit","allowedModules","setAllowedModules","allowedEndpoints","setAllowedEndpoints","saving","setSaving","roleIndex","availableRoles","handleSubmit","modulesJson","mods","m","endpointsJson","eps","r","ChevronDown","apiKey","copied","setCopied","revealed","setRevealed","copyKey","EyeOff","Eye","Copy","message","confirmLabel","confirmClass","onConfirm","handleConfirm"],"mappings":"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","x_google_ignoreList":[0]}
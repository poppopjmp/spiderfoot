import{c as f,r as l,a as m,b as E,j as e,g as X,m as I,y as Y,l as z,n as v,z as ee,A as se,t as te,D as M,G as ae,e as q,v as O,Z as le,H as d,h as ne}from"./index-oKTrG1gL.js";import{L as ie,C as re}from"./layers-CfHSaL6H.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=f("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=f("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=f("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),oe={finding_validator:{icon:te,label:"Finding Validator",color:"text-green-400 bg-green-600/20",description:"Validates and deduplicates scan findings, reducing false positives."},credential_analyzer:{icon:se,label:"Credential Analyzer",color:"text-red-400 bg-red-600/20",description:"Analyzes discovered credentials for severity and exposure risk."},text_summarizer:{icon:de,label:"Text Summarizer",color:"text-blue-400 bg-blue-600/20",description:"Generates concise summaries of large text payloads and documents."},report_generator:{icon:ie,label:"Report Generator",color:"text-purple-400 bg-purple-600/20",description:"Creates executive and technical reports with AI-powered narratives."},document_analyzer:{icon:ee,label:"Document Analyzer",color:"text-orange-400 bg-orange-600/20",description:"Extracts intelligence from uploaded documents and file metadata."},threat_intel:{icon:v,label:"Threat Intel Analyzer",color:"text-yellow-400 bg-yellow-600/20",description:"Correlates findings against threat intelligence databases and IOCs."}};function he(){const[c,G]=l.useState(""),[k,K]=l.useState("domain"),[x,y]=l.useState("recon"),[w,C]=l.useState("low"),[_,$]=l.useState(!0),[t,D]=l.useState(null),[h,H]=l.useState(!1),[g,V]=l.useState(!1),[S,A]=l.useState(0),[p,i]=l.useState(null),{data:n,isLoading:J,refetch:U}=m({queryKey:["agents-status"],queryFn:ne.status,refetchInterval:3e4}),{data:u}=m({queryKey:["ai-presets"],queryFn:d.presets}),{data:j}=m({queryKey:["ai-target-types"],queryFn:d.targetTypes}),{data:b}=m({queryKey:["ai-stealth-levels"],queryFn:d.stealthLevels}),N=(u==null?void 0:u.presets)??[],F=(j==null?void 0:j.target_types)??[],T=(b==null?void 0:b.stealth_levels)??[],L=n!=null&&n.agents?Object.entries(n.agents):[],o=E({mutationFn:s=>d.recommend(s),onSuccess:s=>{D(s.recommendation),A(0)},onError:()=>i({type:"error",message:"Failed to generate recommendation. Check target and settings."})}),R=E({mutationFn:s=>d.feedback(s),onSuccess:()=>i({type:"success",message:"Feedback submitted — thank you!"}),onError:()=>i({type:"error",message:"Failed to submit feedback."})});function Z(s){y(s.id),C(s.stealth)}function B(){if(!c.trim()){i({type:"error",message:"Enter a target."});return}o.mutate({target:c.trim(),target_type:k,objective:x,stealth:w,include_api_key_modules:_})}function Q(s){t&&(A(s),R.mutate({recommendation_id:t.id,rating:s}))}return e.jsxs("div",{children:[p&&e.jsx(X,{type:p.type,message:p.message,onClose:()=>i(null)}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"AI Agents & Scan Intelligence"}),e.jsxs("span",{className:"badge badge-info flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3"})," ",(n==null?void 0:n.total_agents)??0," Agents Online"]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Live Agent Status"}),e.jsx("button",{className:"text-dark-400 hover:text-white transition",onClick:()=>U(),children:e.jsx(Y,{className:"h-4 w-4"})})]}),J?e.jsxs("div",{className:"flex items-center gap-2 text-dark-400 py-8 justify-center",children:[e.jsx(z,{className:"h-5 w-5 animate-spin"})," Loading agents…"]}):L.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(([s,a])=>{const r=oe[s]??{icon:M,label:s,color:"text-dark-400 bg-dark-700",description:""},W=r.icon;return e.jsxs("div",{className:"card hover:border-spider-600/40 border border-transparent transition",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.color.split(" ")[1]}`,children:e.jsx(W,{className:`h-5 w-5 ${r.color.split(" ")[0]}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-white text-sm",children:r.label}),e.jsx("span",{className:`text-xs ${a.status==="idle"?"text-green-400":"text-yellow-400"}`,children:a.status})]})]}),e.jsx("p",{className:"text-xs text-dark-400 mb-3",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-dark-500",children:[e.jsxs("span",{title:"Processed",children:[e.jsx(ae,{className:"h-3 w-3 inline mr-1"}),a.processed_total]}),e.jsxs("span",{title:"Errors",className:a.errors_total>0?"text-red-400":"",children:[e.jsx(v,{className:"h-3 w-3 inline mr-1"}),a.errors_total]}),e.jsxs("span",{title:"Avg time",children:[e.jsx(q,{className:"h-3 w-3 inline mr-1"}),a.avg_processing_time_ms.toFixed(0),"ms"]})]})]},s)})}):e.jsxs("div",{className:"card text-center py-8",children:[e.jsx(M,{className:"h-12 w-12 text-dark-600 mx-auto mb-3"}),e.jsx("p",{className:"text-dark-400",children:"No agents responding."}),e.jsx("p",{className:"text-dark-500 text-sm mt-1",children:"The agents service may be starting up."})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Scan Presets"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:N.map(s=>e.jsxs("button",{onClick:()=>Z(s),className:`card text-left transition hover:border-spider-600/50 border ${x===s.id?"border-spider-500 bg-spider-600/10":"border-transparent"}`,children:[e.jsx("h3",{className:"font-semibold text-white text-sm mb-1",children:s.name}),e.jsx("p",{className:"text-xs text-dark-400 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-dark-500",children:[e.jsxs("span",{children:[e.jsx(q,{className:"h-3 w-3 inline mr-0.5"}),s.estimated_time]}),e.jsxs("span",{children:[e.jsx(re,{className:"h-3 w-3 inline mr-0.5"}),s.module_count," modules"]})]})]},s.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"AI Scan Recommendation"}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-dark-300 mb-4",children:"Get an AI-powered module selection and scan configuration optimized for your target and objective."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-dark-300 mb-1",children:"Target *"}),e.jsx("input",{className:"input-field w-full",value:c,onChange:s=>G(s.target.value),placeholder:"e.g. example.com, 192.168.1.0/24, user@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-dark-300 mb-1",children:"Target Type"}),e.jsx("select",{className:"input-field w-full",value:k,onChange:s=>K(s.target.value),children:F.length>0?F.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id)):e.jsx("option",{value:"domain",children:"Domain"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-dark-300 mb-1",children:"Objective"}),e.jsx("select",{className:"input-field w-full",value:x,onChange:s=>y(s.target.value),children:N.length>0?N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id)):e.jsx("option",{value:"recon",children:"Reconnaissance"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-dark-300 mb-1",children:"Stealth Level"}),e.jsx("select",{className:"input-field w-full",value:w,onChange:s=>C(s.target.value),children:T.length>0?T.map(s=>e.jsxs("option",{value:s.id,children:[s.name," — ",s.description]},s.id)):e.jsx("option",{value:"low",children:"Low"})})]})]}),e.jsxs("button",{className:"text-sm text-dark-400 hover:text-white flex items-center gap-1 mb-4",onClick:()=>H(!h),children:[h?e.jsx(P,{className:"h-4 w-4"}):e.jsx(O,{className:"h-4 w-4"}),"Advanced Options"]}),h&&e.jsx("div",{className:"mb-4 p-3 bg-dark-700/30 rounded-lg space-y-3",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-dark-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:s=>$(s.target.checked),className:"rounded border-dark-600"}),"Include modules requiring API keys"]})}),e.jsx("button",{className:"btn-primary flex items-center gap-2",disabled:!c.trim()||o.isPending,onClick:B,children:o.isPending?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 animate-spin"})," Analyzing…"]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4"})," Get Recommendation"]})}),o.isError&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:"Failed to generate recommendation. Check target and settings."})]})]}),t&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Recommendation Result"}),e.jsxs("div",{className:"card border border-spider-600/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-spider-400"}),t.target]}),e.jsxs("p",{className:"text-xs text-dark-400 mt-1",children:["ID: ",t.id," · Objective: ",t.objective," · Stealth: ",t.stealth_level," · Engine: ",t.engine_version]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-spider-400",children:[(t.confidence*100).toFixed(0),"%"]}),e.jsx("div",{className:"text-[10px] text-dark-500",children:"Confidence"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-dark-700/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:t.module_count}),e.jsx("div",{className:"text-[10px] text-dark-500",children:"Modules"})]}),e.jsxs("div",{className:"bg-dark-700/50 rounded-lg p-3 text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-white",children:[t.estimates.duration_minutes,"m"]}),e.jsx("div",{className:"text-[10px] text-dark-500",children:"Est. Duration"})]}),e.jsxs("div",{className:"bg-dark-700/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:t.estimates.events.toLocaleString()}),e.jsx("div",{className:"text-[10px] text-dark-500",children:"Est. Events"})]}),e.jsxs("div",{className:"bg-dark-700/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:t.estimates.api_calls}),e.jsx("div",{className:"text-[10px] text-dark-500",children:"API Calls"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs("span",{className:"badge badge-info text-xs",children:["Depth: ",t.scope.max_depth]}),t.scope.follow_redirects&&e.jsx("span",{className:"badge badge-info text-xs",children:"Follow Redirects"}),t.scope.include_subdomains&&e.jsx("span",{className:"badge badge-info text-xs",children:"Subdomains"}),t.scope.include_affiliates&&e.jsx("span",{className:"badge badge-info text-xs",children:"Affiliates"})]}),t.warnings.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-600/10 border border-yellow-600/30 rounded-lg",children:[e.jsxs("p",{className:"text-yellow-400 text-sm font-medium mb-1 flex items-center gap-1",children:[e.jsx(v,{className:"h-4 w-4"})," Warnings"]}),e.jsx("ul",{className:"text-xs text-yellow-300/80 space-y-1",children:t.warnings.map((s,a)=>e.jsxs("li",{children:["• ",s]},a))})]}),t.notes.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-dark-700/30 rounded-lg",children:[e.jsx("p",{className:"text-dark-300 text-sm font-medium mb-1",children:"Notes"}),e.jsx("ul",{className:"text-xs text-dark-400 space-y-1",children:t.notes.map((s,a)=>e.jsxs("li",{children:["• ",s]},a))})]}),e.jsxs("button",{className:"text-sm text-dark-400 hover:text-white flex items-center gap-1 mb-3",onClick:()=>V(!g),children:[g?e.jsx(P,{className:"h-4 w-4"}):e.jsx(O,{className:"h-4 w-4"}),t.module_count," Recommended Modules"]}),g&&e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto mb-4",children:t.modules.sort((s,a)=>a.priority-s.priority).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-dark-700/40 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-white font-mono",children:s.module}),e.jsx("p",{className:"text-[10px] text-dark-400 truncate",children:s.reason})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3 flex-shrink-0",children:[e.jsx("span",{className:"badge text-[10px] bg-dark-600 text-dark-300",children:s.category}),e.jsxs("span",{className:"text-xs text-dark-500",children:["P",s.priority]})]})]},s.module))}),t.timing&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-dark-400 mb-2",children:"Timing Config"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(t.timing).map(([s,a])=>e.jsxs("span",{className:"text-[10px] bg-dark-700 text-dark-400 px-2 py-1 rounded font-mono",children:[s,": ",a]},s))})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-3 border-t border-dark-700/50",children:[e.jsx("span",{className:"text-sm text-dark-400",children:"Rate this recommendation:"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>Q(s),disabled:R.isPending,className:"transition",children:e.jsx(ce,{className:`h-5 w-5 ${s<=S?"text-yellow-400 fill-yellow-400":"text-dark-600 hover:text-yellow-400/50"}`})},s))}),S>0&&e.jsx("span",{className:"text-xs text-green-400",children:"Submitted!"})]}),e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"text-xs text-dark-500 cursor-pointer hover:text-dark-300",children:"Raw JSON"}),e.jsx("pre",{className:"mt-2 p-3 bg-dark-800 rounded text-xs text-dark-300 overflow-auto max-h-40",children:JSON.stringify(t,null,2)})]})]})]})]})}export{he as default};
//# sourceMappingURL=Agents-P7OdnvKN.js.map

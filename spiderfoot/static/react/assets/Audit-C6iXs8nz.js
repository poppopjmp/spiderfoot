import{r as x,u as c,j as e,F as u,e as m,f as d}from"./index-OVAqLjZg.js";import{C as p}from"./chart-column-BcFpWbVU.js";function g(){const[l,r]=x.useState(""),{data:a,isLoading:n}=c({queryKey:["audit-logs",l],queryFn:()=>d.list({limit:100,action:l||void 0})}),{data:t}=c({queryKey:["audit-stats"],queryFn:d.stats}),i=(a==null?void 0:a.logs)??(a==null?void 0:a.entries)??[];return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-6",children:"Audit Log"}),t&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[{label:"Total Events",value:t.total??0,color:"text-spider-400"},{label:"Today",value:t.today??0,color:"text-blue-400"},{label:"Unique Users",value:t.unique_users??0,color:"text-purple-400"},{label:"Failed Actions",value:t.failed??0,color:"text-red-400"}].map(s=>e.jsxs("div",{className:"card flex items-center gap-3",children:[e.jsx(p,{className:`h-5 w-5 ${s.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-dark-400",children:s.label}),e.jsx("p",{className:"text-xl font-bold text-white",children:s.value})]})]},s.label))}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(u,{className:"h-4 w-4 text-dark-400"}),e.jsxs("select",{className:"input-field w-48",value:l,onChange:s=>r(s.target.value),children:[e.jsx("option",{value:"",children:"All Actions"}),e.jsx("option",{value:"scan.create",children:"Scan Create"}),e.jsx("option",{value:"scan.delete",children:"Scan Delete"}),e.jsx("option",{value:"config.update",children:"Config Update"}),e.jsx("option",{value:"api_key.create",children:"API Key Create"}),e.jsx("option",{value:"rbac.assign",children:"Role Assignment"}),e.jsx("option",{value:"login",children:"Login"}),e.jsx("option",{value:"export",children:"Export"})]})]}),e.jsx("div",{className:"card",children:n?e.jsx("p",{className:"text-dark-400",children:"Loading audit log..."}):i.length>0?e.jsx("div",{className:"space-y-2",children:i.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"h-4 w-4 text-dark-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-white",children:[e.jsx("span",{className:"badge badge-info mr-2",children:s.action}),s.details||""]}),e.jsxs("p",{className:"text-xs text-dark-400",children:[s.user," Â· ",s.timestamp]})]})]}),e.jsx("span",{className:`badge ${s.success!==!1?"badge-success":"badge-critical"}`,children:s.success!==!1?"OK":"FAILED"})]},s.id||o))}):e.jsx("p",{className:"text-dark-400",children:"No audit log entries found."})})]})}export{g as default};
//# sourceMappingURL=Audit-C6iXs8nz.js.map

import{c as xe,r as l,J as D,j as e,t as Pe,p as Ae,X as me,K as U,M as L,Q as Ue,O as Re,T as Ie,A as Ee,V as Te,W as Fe,v as ie,E as Me}from"./index-DRNKMmPJ.js";import{P as Ge}from"./plus-CVVjuQd7.js";import{P as Be}from"./pencil-B1c8WiFd.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=xe("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=xe("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),Ke=["oauth2","ldap","saml"],$e=["viewer","analyst","operator","admin"],he={oauth2:"OAuth2 / OIDC",ldap:"LDAP",saml:"SAML 2.0"},We={oauth2:e.jsx(Fe,{className:"h-4 w-4 text-blue-400"}),ldap:e.jsx(Te,{className:"h-4 w-4 text-green-400"}),saml:e.jsx(Ee,{className:"h-4 w-4 text-purple-400"})},qe={oauth2:"bg-blue-500/15 text-blue-400 border-blue-500/30",ldap:"bg-green-500/15 text-green-400 border-green-500/30",saml:"bg-purple-500/15 text-purple-400 border-purple-500/30"},f={authorization_url:"https://keycloak.example.com/realms/master/protocol/openid-connect/auth",token_url:"https://keycloak.example.com/realms/master/protocol/openid-connect/token",userinfo_url:"https://keycloak.example.com/realms/master/protocol/openid-connect/userinfo",jwks_uri:"https://keycloak.example.com/realms/master/protocol/openid-connect/certs",scopes:"openid email profile groups",group_attribute:"groups",admin_group:"/spiderfoot-admins"};function He(){const[t,o]=l.useState([]),[m,i]=l.useState(!0),[c,p]=l.useState(""),[d,N]=l.useState(""),[b,g]=l.useState(!1),[j,k]=l.useState(null),[y,S]=l.useState(null),h=l.useCallback(async()=>{var a,u;i(!0),p("");try{const x=await D.get("/api/auth/sso/providers/all");o(x.data.items||[])}catch(x){p(((u=(a=x.response)==null?void 0:a.data)==null?void 0:u.detail)||x.message||"Failed to load SSO providers")}finally{i(!1)}},[]);l.useEffect(()=>{h()},[h]);const v=async a=>{var u,x;try{await D.patch(`/api/auth/sso/providers/${a.id}`,{enabled:!a.enabled}),h()}catch(w){p(((x=(u=w.response)==null?void 0:u.data)==null?void 0:x.detail)||"Failed to toggle provider")}},_=t.filter(a=>{if(!d)return!0;const u=d.toLowerCase();return a.name.toLowerCase().includes(u)||a.protocol.toLowerCase().includes(u)});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(Pe,{className:"h-7 w-7 text-spider-400"}),"SSO Settings"]}),e.jsx("p",{className:"text-dark-400 text-sm mt-1",children:"Configure Single Sign-On providers — OAuth2/OIDC (Keycloak), LDAP, SAML"})]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-spider-600 hover:bg-spider-500 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Add Provider"]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dark-500"}),e.jsx("input",{type:"text",placeholder:"Search providers...",value:d,onChange:a=>N(a.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-dark-800 border border-dark-700 rounded-lg text-sm text-white placeholder:text-dark-500 focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60"}),d&&e.jsx("button",{onClick:()=>N(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-dark-500 hover:text-dark-300",children:e.jsx(me,{className:"h-4 w-4"})})]}),c&&e.jsxs("div",{className:"mb-4 flex items-center gap-2 px-4 py-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[e.jsx(U,{className:"h-4 w-4 flex-shrink-0"}),c]}),e.jsxs("div",{className:"mb-4 px-4 py-3 bg-blue-500/5 border border-blue-500/20 rounded-lg text-sm text-dark-300",children:[e.jsx("p",{className:"font-medium text-blue-400 mb-1",children:"Callback URLs for IDP configuration"}),e.jsxs("p",{className:"text-xs text-dark-400",children:["OAuth2 Redirect: ",e.jsxs("code",{className:"text-blue-300 bg-dark-800 px-1 rounded",children:[window.location.origin,"/api/auth/sso/callback/","<provider_id>"]}),e.jsx("br",{}),"SAML ACS: ",e.jsxs("code",{className:"text-purple-300 bg-dark-800 px-1 rounded",children:[window.location.origin,"/api/auth/sso/saml/acs/","<provider_id>"]})]})]}),e.jsx("div",{className:"space-y-4",children:m?e.jsxs("div",{className:"flex items-center justify-center py-12 text-dark-500",children:[e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-spider-500 border-t-transparent rounded-full mr-3"}),"Loading providers..."]}):_.length===0?e.jsx("div",{className:"text-center py-12 text-dark-500",children:d?"No providers match your search":'No SSO providers configured. Click "Add Provider" to get started.'}):_.map(a=>e.jsx("div",{className:L("bg-dark-800 border rounded-xl p-5 transition-colors",a.enabled?"border-dark-700":"border-dark-700/50 opacity-60"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[We[a.protocol],e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium",children:a.name}),e.jsx("span",{className:L("inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border",qe[a.protocol]||"bg-dark-600 text-dark-300 border-dark-600"),children:he[a.protocol]||a.protocol}),a.enabled?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-green-400",children:[e.jsx(Ue,{className:"h-3 w-3"})," Active"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-dark-500",children:[e.jsx(Re,{className:"h-3 w-3"})," Disabled"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-dark-500",children:[e.jsxs("span",{children:["Default role: ",e.jsx("span",{className:"text-dark-300 capitalize",children:a.default_role})]}),a.admin_group&&e.jsxs("span",{children:["Admin group: ",e.jsx("span",{className:"text-dark-300",children:a.admin_group})]}),a.auto_create_users&&e.jsx("span",{className:"text-green-500/70",children:"Auto-create users"}),a.allowed_domains&&e.jsxs("span",{children:["Domains: ",e.jsx("span",{className:"text-dark-300",children:a.allowed_domains})]})]}),a.protocol==="oauth2"&&a.client_id&&e.jsxs("div",{className:"mt-1 text-xs text-dark-500",children:["Client ID: ",e.jsx("span",{className:"text-dark-400 font-mono",children:a.client_id}),a.userinfo_url&&e.jsxs("span",{className:"ml-3",children:["Userinfo: ",e.jsx("span",{className:"text-dark-400",children:a.userinfo_url})]})]}),a.protocol==="ldap"&&a.ldap_url&&e.jsxs("div",{className:"mt-1 text-xs text-dark-500",children:["URL: ",e.jsx("span",{className:"text-dark-400 font-mono",children:a.ldap_url}),e.jsxs("span",{className:"ml-3",children:["Base DN: ",e.jsx("span",{className:"text-dark-400",children:a.ldap_base_dn})]})]}),a.protocol==="saml"&&a.idp_sso_url&&e.jsxs("div",{className:"mt-1 text-xs text-dark-500",children:["IDP SSO URL: ",e.jsx("span",{className:"text-dark-400",children:a.idp_sso_url})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>v(a),className:"p-1.5 text-dark-500 hover:text-spider-400 hover:bg-dark-700 rounded-lg transition-colors",title:a.enabled?"Disable":"Enable",children:a.enabled?e.jsx(Je,{className:"h-5 w-5 text-green-400"}):e.jsx(ze,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>k(a),className:"p-1.5 text-dark-500 hover:text-spider-400 hover:bg-dark-700 rounded-lg transition-colors",title:"Edit provider",children:e.jsx(Be,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>S(a),className:"p-1.5 text-dark-500 hover:text-red-400 hover:bg-dark-700 rounded-lg transition-colors",title:"Delete provider",children:e.jsx(Ie,{className:"h-3.5 w-3.5"})})]})]})},a.id))}),b&&e.jsx(ue,{onClose:()=>g(!1),onSaved:()=>{g(!1),h()}}),j&&e.jsx(ue,{provider:j,onClose:()=>k(null),onSaved:()=>{k(null),h()}}),y&&e.jsx(Xe,{provider:y,onClose:()=>S(null),onDeleted:()=>{S(null),h()}})]})}function pe({title:t,onClose:o,children:m,wide:i}){return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:o}),e.jsxs("div",{className:L("relative bg-dark-800 border border-dark-700 rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[90vh] overflow-y-auto",i?"max-w-2xl w-full":"max-w-lg w-full"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:t}),e.jsx("button",{onClick:o,className:"text-dark-500 hover:text-dark-300 transition-colors",children:e.jsx(me,{className:"h-5 w-5"})})]}),m]})]})}function n({label:t,hint:o,children:m}){return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300",children:t}),m,o&&e.jsx("p",{className:"text-xs text-dark-500",children:o})]})}const r="w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded-lg text-sm text-white placeholder:text-dark-500 focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60",de="w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-spider-500/40 focus:border-spider-500/60 appearance-none";function ue({provider:t,onClose:o,onSaved:m}){const i=!!t,[c,p]=l.useState((t==null?void 0:t.protocol)||"oauth2"),[d,N]=l.useState((t==null?void 0:t.name)||""),[b,g]=l.useState((t==null?void 0:t.enabled)??!0),[j,k]=l.useState((t==null?void 0:t.default_role)||"viewer"),[y,S]=l.useState((t==null?void 0:t.allowed_domains)||""),[h,v]=l.useState((t==null?void 0:t.auto_create_users)??!0),[_,a]=l.useState((t==null?void 0:t.group_attribute)||"groups"),[u,x]=l.useState((t==null?void 0:t.admin_group)||""),[w,R]=l.useState(""),[I,ge]=l.useState((t==null?void 0:t.client_id)||""),[E,be]=l.useState((t==null?void 0:t.client_secret)||""),[T,F]=l.useState((t==null?void 0:t.authorization_url)||""),[M,G]=l.useState((t==null?void 0:t.token_url)||""),[B,z]=l.useState((t==null?void 0:t.userinfo_url)||""),[J,K]=l.useState((t==null?void 0:t.jwks_uri)||""),[$,W]=l.useState((t==null?void 0:t.scopes)||"openid email profile"),[q,je]=l.useState((t==null?void 0:t.ldap_url)||""),[X,fe]=l.useState((t==null?void 0:t.ldap_bind_dn)||""),[Q,Ne]=l.useState((t==null?void 0:t.ldap_bind_password)||""),[V,ke]=l.useState((t==null?void 0:t.ldap_base_dn)||""),[Y,ye]=l.useState((t==null?void 0:t.ldap_user_filter)||"(uid={username})"),[H,Se]=l.useState((t==null?void 0:t.ldap_group_filter)||"(member={dn})"),[Z,_e]=l.useState((t==null?void 0:t.ldap_tls)??!0),[ee,we]=l.useState((t==null?void 0:t.idp_entity_id)||""),[te,Ce]=l.useState((t==null?void 0:t.idp_sso_url)||""),[se,Oe]=l.useState((t==null?void 0:t.sp_entity_id)||""),[ae,De]=l.useState((t==null?void 0:t.sp_acs_url)||""),[le,P]=l.useState(!1),[ne,A]=l.useState("");l.useEffect(()=>{if(t!=null&&t.attribute_mapping)try{const s=JSON.parse(t.attribute_mapping);s.group_role_map&&R(JSON.stringify(s.group_role_map,null,2))}catch{}},[t]);const Le=()=>{F(f.authorization_url),G(f.token_url),z(f.userinfo_url),K(f.jwks_uri),W(f.scopes),a(f.group_attribute),x(f.admin_group)},ve=async s=>{var ce,oe;s.preventDefault(),P(!0),A("");let re="";try{const O={};w.trim()&&(O.group_role_map=JSON.parse(w)),Object.keys(O).length>0&&(re=JSON.stringify(O))}catch{A('Group→Role mapping must be valid JSON (e.g. {"admins": "admin", "analysts": "analyst"})'),P(!1);return}const C={name:d,protocol:c,enabled:b,default_role:j,allowed_domains:y,auto_create_users:h,attribute_mapping:re,group_attribute:_,admin_group:u};c==="oauth2"?Object.assign(C,{client_id:I,client_secret:E,authorization_url:T,token_url:M,userinfo_url:B,jwks_uri:J,scopes:$}):c==="ldap"?Object.assign(C,{ldap_url:q,ldap_bind_dn:X,ldap_bind_password:Q,ldap_base_dn:V,ldap_user_filter:Y,ldap_group_filter:H,ldap_tls:Z}):c==="saml"&&Object.assign(C,{idp_entity_id:ee,idp_sso_url:te,sp_entity_id:se,sp_acs_url:ae});try{i?await D.patch(`/api/auth/sso/providers/${t.id}`,C):await D.post("/api/auth/sso/providers",C),m()}catch(O){A(((oe=(ce=O.response)==null?void 0:ce.data)==null?void 0:oe.detail)||"Failed to save provider")}finally{P(!1)}};return e.jsx(pe,{title:i?`Edit ${t.name}`:"Add SSO Provider",onClose:o,wide:!0,children:e.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[ne&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[e.jsx(U,{className:"h-4 w-4 flex-shrink-0"}),ne]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Provider Name",children:e.jsx("input",{type:"text",value:d,onChange:s=>N(s.target.value),required:!0,className:r,placeholder:"e.g. Keycloak"})}),e.jsx(n,{label:"Protocol",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:c,onChange:s=>p(s.target.value),disabled:i,className:de,children:Ke.map(s=>e.jsx("option",{value:s,children:he[s]},s))}),e.jsx(ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dark-500 pointer-events-none"})]})})]}),c==="oauth2"&&!i&&e.jsxs("button",{type:"button",onClick:Le,className:"flex items-center gap-2 px-3 py-1.5 text-xs text-blue-400 bg-blue-500/10 border border-blue-500/20 rounded-lg hover:bg-blue-500/20 transition-colors",children:[e.jsx(Me,{className:"h-3 w-3"})," Fill Keycloak defaults (edit URLs to match your realm)"]}),c==="oauth2"&&e.jsxs("div",{className:"space-y-4 pt-2 border-t border-dark-700/50",children:[e.jsx("p",{className:"text-xs text-dark-500 font-medium uppercase tracking-wider",children:"OAuth2 / OIDC Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Client ID",children:e.jsx("input",{type:"text",value:I,onChange:s=>ge(s.target.value),className:r,placeholder:"spiderfoot-client"})}),e.jsx(n,{label:"Client Secret",children:e.jsx("input",{type:"password",value:E,onChange:s=>be(s.target.value),className:r,placeholder:"••••••••"})})]}),e.jsx(n,{label:"Authorization URL",hint:"OIDC authorization endpoint",children:e.jsx("input",{type:"url",value:T,onChange:s=>F(s.target.value),className:r,placeholder:"https://keycloak.example.com/realms/master/protocol/openid-connect/auth"})}),e.jsx(n,{label:"Token URL",hint:"OIDC token endpoint",children:e.jsx("input",{type:"url",value:M,onChange:s=>G(s.target.value),className:r,placeholder:"https://keycloak.example.com/realms/master/protocol/openid-connect/token"})}),e.jsx(n,{label:"Userinfo URL",hint:"OIDC userinfo endpoint",children:e.jsx("input",{type:"url",value:B,onChange:s=>z(s.target.value),className:r,placeholder:"https://keycloak.example.com/realms/master/protocol/openid-connect/userinfo"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"JWKS URI",hint:"JSON Web Key Set URL (optional)",children:e.jsx("input",{type:"url",value:J,onChange:s=>K(s.target.value),className:r,placeholder:"https://..."})}),e.jsx(n,{label:"Scopes",hint:"Space-separated",children:e.jsx("input",{type:"text",value:$,onChange:s=>W(s.target.value),className:r,placeholder:"openid email profile groups"})})]})]}),c==="ldap"&&e.jsxs("div",{className:"space-y-4 pt-2 border-t border-dark-700/50",children:[e.jsx("p",{className:"text-xs text-dark-500 font-medium uppercase tracking-wider",children:"LDAP Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"LDAP URL",children:e.jsx("input",{type:"text",value:q,onChange:s=>je(s.target.value),className:r,placeholder:"ldaps://ldap.example.com:636"})}),e.jsx(n,{label:"Base DN",children:e.jsx("input",{type:"text",value:V,onChange:s=>ke(s.target.value),className:r,placeholder:"dc=example,dc=com"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Bind DN",hint:"Service account DN",children:e.jsx("input",{type:"text",value:X,onChange:s=>fe(s.target.value),className:r,placeholder:"cn=admin,dc=example,dc=com"})}),e.jsx(n,{label:"Bind Password",children:e.jsx("input",{type:"password",value:Q,onChange:s=>Ne(s.target.value),className:r})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"User Filter",hint:"{username} is replaced",children:e.jsx("input",{type:"text",value:Y,onChange:s=>ye(s.target.value),className:r})}),e.jsx(n,{label:"Group Filter",hint:"{dn} is replaced",children:e.jsx("input",{type:"text",value:H,onChange:s=>Se(s.target.value),className:r})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-dark-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Z,onChange:s=>_e(s.target.checked),className:"rounded border-dark-600 bg-dark-900 text-spider-600 focus:ring-spider-500/40"}),"Use TLS (StartTLS)"]})]}),c==="saml"&&e.jsxs("div",{className:"space-y-4 pt-2 border-t border-dark-700/50",children:[e.jsx("p",{className:"text-xs text-dark-500 font-medium uppercase tracking-wider",children:"SAML 2.0 Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"IDP Entity ID",children:e.jsx("input",{type:"text",value:ee,onChange:s=>we(s.target.value),className:r,placeholder:"https://idp.example.com/saml/metadata"})}),e.jsx(n,{label:"IDP SSO URL",children:e.jsx("input",{type:"url",value:te,onChange:s=>Ce(s.target.value),className:r,placeholder:"https://idp.example.com/saml/sso"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"SP Entity ID",children:e.jsx("input",{type:"text",value:se,onChange:s=>Oe(s.target.value),className:r,placeholder:"spiderfoot"})}),e.jsx(n,{label:"SP ACS URL",children:e.jsx("input",{type:"url",value:ae,onChange:s=>De(s.target.value),className:r,placeholder:`${window.location.origin}/api/auth/sso/saml/acs/...`})})]})]}),e.jsxs("div",{className:"space-y-4 pt-2 border-t border-dark-700/50",children:[e.jsx("p",{className:"text-xs text-dark-500 font-medium uppercase tracking-wider",children:"User Provisioning & Role Mapping"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Default Role",hint:"Role assigned to new SSO users",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:j,onChange:s=>k(s.target.value),className:de,children:$e.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsx(ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-dark-500 pointer-events-none"})]})}),e.jsx(n,{label:"Allowed Domains",hint:"Comma-separated, empty = all",children:e.jsx("input",{type:"text",value:y,onChange:s=>S(s.target.value),className:r,placeholder:"example.com, corp.io"})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-dark-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:s=>v(s.target.checked),className:"rounded border-dark-600 bg-dark-900 text-spider-600 focus:ring-spider-500/40"}),"Auto-create users on first SSO login"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Group Attribute",hint:"Claim name in OIDC userinfo containing groups",children:e.jsx("input",{type:"text",value:_,onChange:s=>a(s.target.value),className:r,placeholder:"groups"})}),e.jsx(n,{label:"Admin Group",hint:"Group name that grants admin role",children:e.jsx("input",{type:"text",value:u,onChange:s=>x(s.target.value),className:r,placeholder:"/spiderfoot-admins"})})]}),e.jsx(n,{label:"Group → Role Mapping (JSON)",hint:'Map IDP groups to SpiderFoot roles. e.g. {"analysts": "analyst", "ops-team": "operator"}',children:e.jsx("textarea",{value:w,onChange:s=>R(s.target.value),rows:4,className:L(r,"font-mono text-xs"),placeholder:'{\\n  "sf-analysts": "analyst",\\n  "sf-operators": "operator",\\n  "sf-admins": "admin"\\n}'})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-dark-700/50",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-dark-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:s=>g(s.target.checked),className:"rounded border-dark-600 bg-dark-900 text-spider-600 focus:ring-spider-500/40"}),"Enabled"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:le,className:"px-4 py-2 bg-spider-600 hover:bg-spider-500 disabled:opacity-50 text-white rounded-lg text-sm font-medium transition-colors",children:le?"Saving...":i?"Save Changes":"Create Provider"})]})]})]})})}function Xe({provider:t,onClose:o,onDeleted:m}){const[i,c]=l.useState(!1),[p,d]=l.useState(""),N=async()=>{var b,g;c(!0),d("");try{await D.delete(`/api/auth/sso/providers/${t.id}`),m()}catch(j){d(((g=(b=j.response)==null?void 0:b.data)==null?void 0:g.detail)||"Failed to delete provider"),c(!1)}};return e.jsx(pe,{title:"Delete SSO Provider",onClose:o,children:e.jsxs("div",{className:"space-y-4",children:[p&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[e.jsx(U,{className:"h-4 w-4 flex-shrink-0"}),p]}),e.jsxs("p",{className:"text-dark-300 text-sm",children:["Are you sure you want to delete the SSO provider"," ",e.jsx("span",{className:"text-white font-medium",children:t.name}),"? Users who authenticated via this provider will no longer be able to sign in through SSO."]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:N,disabled:i,className:"px-4 py-2 bg-red-600 hover:bg-red-500 disabled:opacity-50 text-white rounded-lg text-sm font-medium transition-colors",children:i?"Deleting...":"Delete Provider"})]})]})})}export{He as default};
//# sourceMappingURL=SSOSettings-C1MqTpE-.js.map

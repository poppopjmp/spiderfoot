{"version":3,"file":"SSO-DWlbsTeh.js","sources":["../../../../frontend/src/pages/SSO.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\r\nimport { ssoApi } from '../lib/api';\r\nimport { Lock, Plus, Users, Key, Trash2, Shield } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nexport default function SSOPage() {\r\n  const [tab, setTab] = useState<'providers' | 'sessions'>('providers');\r\n  const { data: providers } = useQuery({ queryKey: ['sso-providers'], queryFn: ssoApi.listProviders });\r\n  const { data: sessions } = useQuery({ queryKey: ['sso-sessions'], queryFn: ssoApi.sessions });\r\n  const { data: stats } = useQuery({ queryKey: ['sso-stats'], queryFn: ssoApi.stats });\r\n\r\n  const providerList = providers?.providers ?? [];\r\n  const sessionList = sessions?.sessions ?? [];\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h1 className=\"text-2xl font-bold text-white\">Single Sign-On (SSO)</h1>\r\n        <button className=\"btn-primary flex items-center gap-2\">\r\n          <Plus className=\"h-4 w-4\" /> Add Provider\r\n        </button>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      {stats && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n          <div className=\"card flex items-center gap-3\">\r\n            <Shield className=\"h-5 w-5 text-spider-400\" />\r\n            <div>\r\n              <p className=\"text-sm text-dark-400\">Providers</p>\r\n              <p className=\"text-xl font-bold text-white\">{stats.total_providers ?? providerList.length}</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"card flex items-center gap-3\">\r\n            <Users className=\"h-5 w-5 text-blue-400\" />\r\n            <div>\r\n              <p className=\"text-sm text-dark-400\">Active Sessions</p>\r\n              <p className=\"text-xl font-bold text-white\">{stats.active_sessions ?? sessionList.length}</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"card flex items-center gap-3\">\r\n            <Key className=\"h-5 w-5 text-green-400\" />\r\n            <div>\r\n              <p className=\"text-sm text-dark-400\">JIT Provisioned</p>\r\n              <p className=\"text-xl font-bold text-white\">{stats.jit_provisioned ?? 0}</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"card flex items-center gap-3\">\r\n            <Lock className=\"h-5 w-5 text-purple-400\" />\r\n            <div>\r\n              <p className=\"text-sm text-dark-400\">SSO Logins (24h)</p>\r\n              <p className=\"text-xl font-bold text-white\">{stats.logins_24h ?? 0}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex gap-1 mb-6 bg-dark-800 rounded-lg p-1 w-fit\">\r\n        <button\r\n          onClick={() => setTab('providers')}\r\n          className={`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors ${\r\n            tab === 'providers' ? 'bg-spider-600 text-white' : 'text-dark-300 hover:text-white hover:bg-dark-700'\r\n          }`}\r\n        >\r\n          <Shield className=\"h-4 w-4\" /> Identity Providers\r\n        </button>\r\n        <button\r\n          onClick={() => setTab('sessions')}\r\n          className={`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors ${\r\n            tab === 'sessions' ? 'bg-spider-600 text-white' : 'text-dark-300 hover:text-white hover:bg-dark-700'\r\n          }`}\r\n        >\r\n          <Users className=\"h-4 w-4\" /> Sessions\r\n        </button>\r\n      </div>\r\n\r\n      {/* Providers */}\r\n      {tab === 'providers' && (\r\n        <div className=\"space-y-3\">\r\n          {providerList.map((p: { id: string; name: string; protocol: string; entity_id: string; enabled: boolean; allowed_domains?: string[] }) => (\r\n            <div key={p.id} className=\"card flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className={`p-2 rounded-lg ${p.enabled ? 'bg-green-600/20' : 'bg-dark-700'}`}>\r\n                  <Lock className={`h-5 w-5 ${p.enabled ? 'text-green-400' : 'text-dark-500'}`} />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-medium text-white\">{p.name}</h3>\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <span className=\"badge badge-info uppercase\">{p.protocol}</span>\r\n                    <span className=\"text-xs text-dark-400 font-mono\">{p.entity_id}</span>\r\n                  </div>\r\n                  {p.allowed_domains && p.allowed_domains.length > 0 && (\r\n                    <div className=\"flex gap-1 mt-1\">\r\n                      {p.allowed_domains.map((d) => (\r\n                        <span key={d} className=\"badge badge-low text-xs\">{d}</span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <button className=\"text-red-400 hover:text-red-300\"><Trash2 className=\"h-4 w-4\" /></button>\r\n                <span className={`badge ${p.enabled ? 'badge-success' : 'badge-info'}`}>\r\n                  {p.enabled ? 'Active' : 'Disabled'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Sessions */}\r\n      {tab === 'sessions' && (\r\n        <div className=\"card\">\r\n          <h2 className=\"text-lg font-semibold text-white mb-4\">Active SSO Sessions</h2>\r\n          {sessionList.length > 0 ? (\r\n            <table className=\"w-full text-sm\">\r\n              <thead>\r\n                <tr className=\"text-left text-dark-400 border-b border-dark-700\">\r\n                  <th className=\"pb-3 font-medium\">User</th>\r\n                  <th className=\"pb-3 font-medium\">Provider</th>\r\n                  <th className=\"pb-3 font-medium\">Created</th>\r\n                  <th className=\"pb-3 font-medium\">Expires</th>\r\n                  <th className=\"pb-3 font-medium\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-dark-700\">\r\n                {sessionList.map((s: { id: string; user: string; provider: string; created_at: string; expires_at: string }) => (\r\n                  <tr key={s.id}>\r\n                    <td className=\"py-3 text-white\">{s.user}</td>\r\n                    <td className=\"py-3 text-dark-300\">{s.provider}</td>\r\n                    <td className=\"py-3 text-dark-400\">{s.created_at}</td>\r\n                    <td className=\"py-3 text-dark-400\">{s.expires_at}</td>\r\n                    <td className=\"py-3\"><button className=\"text-red-400 text-sm hover:underline\">Revoke</button></td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          ) : (\r\n            <p className=\"text-dark-400\">No active SSO sessions.</p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["SSOPage","tab","setTab","useState","providers","useQuery","ssoApi","sessions","stats","providerList","sessionList","jsxs","jsx","Plus","Shield","Users","Key","Lock","p","d","Trash2"],"mappings":"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"}
import{c as h,u as c,j as e,M as m,g as o,S as j,z as p,N as d}from"./index-OVAqLjZg.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=h("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function N(){var r;const{data:a}=c({queryKey:["asm-dashboard"],queryFn:d.dashboard}),{data:l}=c({queryKey:["asm-assets"],queryFn:d.listAssets}),{data:t}=c({queryKey:["asm-policies"],queryFn:d.policies}),i=(l==null?void 0:l.assets)??[];return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-6",children:"Attack Surface Management"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[{label:"Total Assets",value:(a==null?void 0:a.total_assets)??i.length,icon:m,color:"text-spider-400"},{label:"Critical Exposure",value:(a==null?void 0:a.critical)??0,icon:o,color:"text-red-400"},{label:"Active Policies",value:(a==null?void 0:a.active_policies)??((r=t==null?void 0:t.policies)==null?void 0:r.length)??0,icon:j,color:"text-green-400"},{label:"External Services",value:(a==null?void 0:a.external_services)??0,icon:b,color:"text-blue-400"}].map(s=>e.jsxs("div",{className:"card flex items-center gap-3",children:[e.jsx(s.icon,{className:`h-5 w-5 ${s.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-dark-400",children:s.label}),e.jsx("p",{className:"text-xl font-bold text-white",children:s.value})]})]},s.label))}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Discovered Assets"}),i.length>0?e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-dark-400 border-b border-dark-700",children:[e.jsx("th",{className:"pb-3 font-medium",children:"Asset"}),e.jsx("th",{className:"pb-3 font-medium",children:"Type"}),e.jsx("th",{className:"pb-3 font-medium",children:"Risk"}),e.jsx("th",{className:"pb-3 font-medium",children:"Last Seen"}),e.jsx("th",{className:"pb-3 font-medium",children:"Tags"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-700",children:i.map(s=>{var n;return e.jsxs("tr",{className:"hover:bg-dark-700/50",children:[e.jsxs("td",{className:"py-3 text-white flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-dark-400"})," ",s.name]}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:"badge badge-info",children:s.type})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`badge ${s.risk==="critical"?"badge-critical":s.risk==="high"?"badge-high":s.risk==="medium"?"badge-medium":"badge-low"}`,children:s.risk})}),e.jsx("td",{className:"py-3 text-dark-400",children:s.last_seen}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"flex gap-1",children:(n=s.tags)==null?void 0:n.map(x=>e.jsx("span",{className:"badge badge-low text-xs",children:x},x))})})]},s.id)})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(m,{className:"h-12 w-12 text-dark-600 mx-auto mb-3"}),e.jsx("p",{className:"text-dark-400",children:"No assets discovered yet."}),e.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"Run a scan with ASM modules enabled to discover your external attack surface."})]})]}),(t==null?void 0:t.policies)&&t.policies.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Security Policies"}),e.jsx("div",{className:"space-y-2",children:t.policies.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-dark-400",children:s.description})]}),e.jsx("span",{className:`badge ${s.enabled?"badge-success":"badge-info"}`,children:s.enabled?"Active":"Disabled"})]},s.id))})]})]})}export{N as default};
//# sourceMappingURL=ASM-C3DKhh3A.js.map

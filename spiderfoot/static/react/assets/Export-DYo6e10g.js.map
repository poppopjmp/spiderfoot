{"version":3,"file":"Export-DYo6e10g.js","sources":["../../../../frontend/node_modules/lucide-react/dist/esm/icons/file-json.js","../../../../frontend/node_modules/lucide-react/dist/esm/icons/file-spreadsheet.js","../../../../frontend/src/pages/Export.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst FileJson = createLucideIcon(\"FileJson\", [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\n    \"path\",\n    { d: \"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1\", key: \"1oajmo\" }\n  ],\n  [\n    \"path\",\n    { d: \"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1\", key: \"mpwhp6\" }\n  ]\n]);\n\nexport { FileJson as default };\n//# sourceMappingURL=file-json.js.map\n","/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst FileSpreadsheet = createLucideIcon(\"FileSpreadsheet\", [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"M8 13h2\", key: \"yr2amv\" }],\n  [\"path\", { d: \"M14 13h2\", key: \"un5t4a\" }],\n  [\"path\", { d: \"M8 17h2\", key: \"2yhykz\" }],\n  [\"path\", { d: \"M14 17h2\", key: \"10kma7\" }]\n]);\n\nexport { FileSpreadsheet as default };\n//# sourceMappingURL=file-spreadsheet.js.map\n","import { useQuery } from '@tanstack/react-query';\r\nimport { scanApi } from '../lib/api';\r\nimport { FileDown, FileJson, Shield, Bug, FileSpreadsheet, FileText } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nexport default function ExportPage() {\r\n  const [selectedScan, setSelectedScan] = useState('');\r\n  const { data: scans } = useQuery({ queryKey: ['scans'], queryFn: scanApi.list });\r\n\r\n  const formats = [\r\n    {\r\n      id: 'csv', name: 'CSV', description: 'Comma-separated values for spreadsheet tools',\r\n      icon: FileSpreadsheet, color: 'text-green-400 bg-green-600/20',\r\n      endpoint: `/api/v1/scans/${selectedScan}/export/csv`,\r\n    },\r\n    {\r\n      id: 'json', name: 'JSON', description: 'Structured JSON export of all scan data',\r\n      icon: FileJson, color: 'text-blue-400 bg-blue-600/20',\r\n      endpoint: `/api/v1/scans/${selectedScan}/export/json`,\r\n    },\r\n    {\r\n      id: 'stix', name: 'STIX 2.1', description: 'Structured Threat Information Expression (TAXII compatible)',\r\n      icon: Shield, color: 'text-purple-400 bg-purple-600/20',\r\n      endpoint: `/api/v1/stix/bundle/${selectedScan}`,\r\n    },\r\n    {\r\n      id: 'sarif', name: 'SARIF', description: 'Static Analysis Results Interchange Format (for GitHub/Azure DevOps)',\r\n      icon: Bug, color: 'text-orange-400 bg-orange-600/20',\r\n      endpoint: `/api/v1/sarif/report/${selectedScan}`,\r\n    },\r\n    {\r\n      id: 'pdf', name: 'PDF Report', description: 'Formatted PDF report using custom templates',\r\n      icon: FileText, color: 'text-red-400 bg-red-600/20',\r\n      endpoint: `/api/v1/reports/generate`,\r\n    },\r\n  ];\r\n\r\n  const handleExport = (format: typeof formats[0]) => {\r\n    if (!selectedScan) return;\r\n    window.open(format.endpoint, '_blank');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-bold text-white mb-6\">Export & Integrations</h1>\r\n\r\n      {/* Scan selector */}\r\n      <div className=\"card mb-6\">\r\n        <h2 className=\"text-lg font-semibold text-white mb-3\">Select Scan to Export</h2>\r\n        <select\r\n          className=\"input-field w-full max-w-md\"\r\n          value={selectedScan}\r\n          onChange={(e) => setSelectedScan(e.target.value)}\r\n        >\r\n          <option value=\"\">Choose a scan...</option>\r\n          {scans?.map((s) => (\r\n            <option key={s.id} value={s.id}>{s.name} â€” {s.target} ({s.status})</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Export formats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\r\n        {formats.map((f) => (\r\n          <div key={f.id} className=\"card hover:border-spider-600 border border-transparent transition-colors\">\r\n            <div className=\"flex items-start gap-3 mb-4\">\r\n              <div className={`p-3 rounded-lg ${f.color.split(' ')[1]}`}>\r\n                <f.icon className={`h-6 w-6 ${f.color.split(' ')[0]}`} />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"text-white font-semibold\">{f.name}</h3>\r\n                <p className=\"text-sm text-dark-400 mt-1\">{f.description}</p>\r\n              </div>\r\n            </div>\r\n            <button\r\n              className=\"btn-primary w-full flex items-center justify-center gap-2\"\r\n              onClick={() => handleExport(f)}\r\n              disabled={!selectedScan}\r\n            >\r\n              <FileDown className=\"h-4 w-4\" /> Export {f.name}\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Integration info */}\r\n      <div className=\"card\">\r\n        <h2 className=\"text-lg font-semibold text-white mb-4\">TAXII Server</h2>\r\n        <p className=\"text-sm text-dark-400 mb-3\">\r\n          SpiderFoot includes a built-in TAXII 2.1 server for automated threat intelligence sharing.\r\n        </p>\r\n        <div className=\"space-y-2 text-sm\">\r\n          <div className=\"flex items-center gap-3 p-3 bg-dark-700/50 rounded-lg\">\r\n            <span className=\"text-dark-300 w-32\">Discovery URL</span>\r\n            <code className=\"text-spider-400 font-mono\">/api/v1/taxii/discovery</code>\r\n          </div>\r\n          <div className=\"flex items-center gap-3 p-3 bg-dark-700/50 rounded-lg\">\r\n            <span className=\"text-dark-300 w-32\">API Root</span>\r\n            <code className=\"text-spider-400 font-mono\">/api/v1/taxii/api-root</code>\r\n          </div>\r\n          <div className=\"flex items-center gap-3 p-3 bg-dark-700/50 rounded-lg\">\r\n            <span className=\"text-dark-300 w-32\">Collections</span>\r\n            <code className=\"text-spider-400 font-mono\">/api/v1/taxii/collections</code>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["FileJson","createLucideIcon","FileSpreadsheet","ExportPage","selectedScan","setSelectedScan","useState","scans","useQuery","scanApi","formats","Shield","Bug","FileText","handleExport","format","jsx","jsxs","e","s","f","FileDown"],"mappings":"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","x_google_ignoreList":[0,1]}
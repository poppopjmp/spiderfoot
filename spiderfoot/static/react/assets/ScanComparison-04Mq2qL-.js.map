{"version":3,"file":"ScanComparison-04Mq2qL-.js","sources":["../../../../frontend/node_modules/lucide-react/dist/esm/icons/trending-down.js","../../../../frontend/node_modules/lucide-react/dist/esm/icons/trending-up.js","../../../../frontend/src/pages/ScanComparison.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingDown = createLucideIcon(\"TrendingDown\", [\n  [\"polyline\", { points: \"22 17 13.5 8.5 8.5 13.5 2 7\", key: \"1r2t7k\" }],\n  [\"polyline\", { points: \"16 17 22 17 22 11\", key: \"11uiuu\" }]\n]);\n\nexport { TrendingDown as default };\n//# sourceMappingURL=trending-down.js.map\n","/**\n * @license lucide-react v0.460.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingUp = createLucideIcon(\"TrendingUp\", [\n  [\"polyline\", { points: \"22 7 13.5 15.5 8.5 10.5 2 17\", key: \"126l90\" }],\n  [\"polyline\", { points: \"16 7 22 7 22 13\", key: \"kwv8wd\" }]\n]);\n\nexport { TrendingUp as default };\n//# sourceMappingURL=trending-up.js.map\n","import { useQuery } from '@tanstack/react-query';\r\nimport { scanCompareApi, scanApi } from '../lib/api';\r\nimport { GitCompare, ArrowRight, TrendingUp, TrendingDown } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nexport default function ScanComparisonPage() {\r\n  const [scanA, setScanA] = useState('');\r\n  const [scanB, setScanB] = useState('');\r\n  const [result, setResult] = useState<Record<string, unknown> | null>(null);\r\n\r\n  const { data: scans } = useQuery({ queryKey: ['scans'], queryFn: scanApi.list });\r\n  const { data: history } = useQuery({ queryKey: ['compare-history'], queryFn: scanCompareApi.history });\r\n  const { data: categories } = useQuery({ queryKey: ['compare-categories'], queryFn: scanCompareApi.categories });\r\n\r\n  const handleCompare = async () => {\r\n    if (!scanA || !scanB) return;\r\n    const res = await scanCompareApi.quick({ scan_a_id: scanA, scan_b_id: scanB });\r\n    setResult(res);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-bold text-white mb-6\">Scan Comparison</h1>\r\n\r\n      {/* Compare form */}\r\n      <div className=\"card mb-6\">\r\n        <h2 className=\"text-lg font-semibold text-white mb-4\">Compare Two Scans</h2>\r\n        <div className=\"flex items-center gap-4\">\r\n          <select className=\"input-field flex-1\" value={scanA} onChange={(e) => setScanA(e.target.value)}>\r\n            <option value=\"\">Select Scan A</option>\r\n            {scans?.map((s) => <option key={s.id} value={s.id}>{s.name} ({s.target})</option>)}\r\n          </select>\r\n          <ArrowRight className=\"h-5 w-5 text-dark-400 flex-shrink-0\" />\r\n          <select className=\"input-field flex-1\" value={scanB} onChange={(e) => setScanB(e.target.value)}>\r\n            <option value=\"\">Select Scan B</option>\r\n            {scans?.map((s) => <option key={s.id} value={s.id}>{s.name} ({s.target})</option>)}\r\n          </select>\r\n          <button className=\"btn-primary flex items-center gap-2\" onClick={handleCompare} disabled={!scanA || !scanB}>\r\n            <GitCompare className=\"h-4 w-4\" /> Compare\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Result */}\r\n      {result && (\r\n        <div className=\"space-y-4 mb-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div className=\"card\">\r\n              <p className=\"text-sm text-dark-400\">Risk Delta</p>\r\n              <p className={`text-2xl font-bold ${\r\n                (result.risk_delta as number) > 0 ? 'text-red-400' :\r\n                (result.risk_delta as number) < 0 ? 'text-green-400' : 'text-white'\r\n              }`}>\r\n                {(result.risk_delta as number) > 0 ? '+' : ''}{result.risk_delta as number}\r\n                {(result.risk_delta as number) > 0 ? <TrendingUp className=\"h-4 w-4 inline ml-1\" /> : <TrendingDown className=\"h-4 w-4 inline ml-1\" />}\r\n              </p>\r\n            </div>\r\n            <div className=\"card\">\r\n              <p className=\"text-sm text-dark-400\">Risk Grade</p>\r\n              <p className=\"text-2xl font-bold text-white\">{result.risk_grade as string}</p>\r\n            </div>\r\n            <div className=\"card\">\r\n              <p className=\"text-sm text-dark-400\">Events Changed</p>\r\n              <p className=\"text-2xl font-bold text-white\">\r\n                <span className=\"text-green-400\">+{(result.added as number) ?? 0}</span>\r\n                {' / '}\r\n                <span className=\"text-red-400\">-{(result.removed as number) ?? 0}</span>\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Category breakdown */}\r\n          {result.categories && (\r\n            <div className=\"card\">\r\n              <h3 className=\"text-white font-semibold mb-3\">Category Breakdown</h3>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-5 gap-3\">\r\n                {Object.entries(result.categories as Record<string, { added: number; removed: number }>).map(([cat, diff]) => (\r\n                  <div key={cat} className=\"p-3 bg-dark-700/50 rounded-lg\">\r\n                    <p className=\"text-xs text-dark-400 capitalize\">{cat}</p>\r\n                    <p className=\"text-sm text-white\">\r\n                      <span className=\"text-green-400\">+{diff.added}</span>\r\n                      {' '}\r\n                      <span className=\"text-red-400\">-{diff.removed}</span>\r\n                    </p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Available categories */}\r\n      {categories?.categories && (\r\n        <div className=\"card mb-6\">\r\n          <h2 className=\"text-lg font-semibold text-white mb-3\">Event Categories</h2>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {(categories.categories as string[]).map((c) => (\r\n              <span key={c} className=\"badge badge-info capitalize\">{c}</span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* History */}\r\n      <div className=\"card\">\r\n        <h2 className=\"text-lg font-semibold text-white mb-4\">Comparison History</h2>\r\n        {(history?.history ?? []).length > 0 ? (\r\n          <div className=\"space-y-2\">\r\n            {(history.history as { id: string; scan_a: string; scan_b: string; risk_delta: number; timestamp: string }[]).map((h) => (\r\n              <div key={h.id} className=\"flex items-center justify-between p-3 bg-dark-700/30 rounded-lg text-sm\">\r\n                <span className=\"text-white\">{h.scan_a} vs {h.scan_b}</span>\r\n                <span className={`font-medium ${h.risk_delta > 0 ? 'text-red-400' : 'text-green-400'}`}>\r\n                  {h.risk_delta > 0 ? '+' : ''}{h.risk_delta}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-dark-400\">No comparisons performed yet.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["TrendingDown","createLucideIcon","TrendingUp","ScanComparisonPage","scanA","setScanA","useState","scanB","setScanB","result","setResult","scans","useQuery","scanApi","history","scanCompareApi","categories","handleCompare","res","jsx","jsxs","e","ArrowRight","GitCompare","cat","diff","c","h"],"mappings":"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","x_google_ignoreList":[0,1]}